<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <title>Hà Tools</title>
  <meta name="keywords" content="HTML5,CSS3,Admin Template" />
  <meta name="description" content="" />
  <meta name="Author" content="HaTool" />

  <!-- mobile settings -->
  <meta name="viewport" content="width=device-width, maximum-scale=1, initial-scale=1, user-scalable=0" />
  <!--[if IE]><meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'><![endif]-->

  <!-- WEB FONTS : use %7C instead of | (pipe) -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400%7CRaleway:300,400,500,600,700%7CLato:300,400,400italic,600,700"
    rel="stylesheet" type="text/css" />

  <!-- CORE CSS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <link href="assets/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
  <link href="assets/plugins/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
  <link href="assets/plugins/simple-line-icons-master/css/simple-line-icons.css" rel="stylesheet" type="text/css" />
  <link href="assets/plugins/animate/animate.css" rel="stylesheet" type="text/css" />
  <link href="assets/plugins/ui/jquery-ui.css" rel="stylesheet">
  <link rel="stylesheet" href="assets/plugins/toastr/toastr.min.css" />
  <!-- THEME CSS -->
  <link href="assets/css/style.css" rel="stylesheet" type="text/css" />
  <link href="assets/css/theme/dark.css" rel="stylesheet" type="text/css" />
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.13/semantic.min.css">
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/6.6.9/sweetalert2.min.css">
  <link rel="manifest" href="/manifest.json">
  <link href="https://cdn.rawgit.com/mdehoog/Semantic-UI-Calendar/76959c6f7d33a527b49be76789e984a0a407350b/dist/calendar.min.css"
    rel="stylesheet" type="text/css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.13/semantic.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/6.6.9/sweetalert2.min.js"></script>
  <script src="https://cdn.rawgit.com/mdehoog/Semantic-UI-Calendar/76959c6f7d33a527b49be76789e984a0a407350b/dist/calendar.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.5/angular.min.js"></script>
  <script src="assets/plugins/calendar/moment.min.js"></script>
  <script src="assets/plugins/toastr/toastr.min.js"></script>
  <script src="assets/plugins/ui/jquery-ui.js"></script>

</head>

<body ng-app="">

  <!-- wrapper -->
  <div id="wrapper">
    <!-- BEGIN HEADER -->
    <div class="page-header navbar fixed-top">
      <!-- BEGIN HEADER INNER -->
      <div class="page-header-inner ">
        <!-- BEGIN LOGO -->
        <div class="menu-toggler sidebar-toggler">
          <h2 style="font-size: 20px;
            float: right;
            margin-left: 25px;
            color: white;"> Hà Tools</h2>

          <a href="javascript:;" id="menubtn" class="navbar-minimalize minimalize-styl-2  float-left ">
            <i class="fa fa-bars"></i>
          </a>
        </div>
      </div>
      <!-- END LOGO -->

      <!-- BEGIN TOP NAVIGATION MENU -->

      <!-- END USER LOGIN DROPDOWN -->
      <!-- BEGIN QUICK SIDEBAR TOGGLER -->
      <!-- DOC: Apply "dropdown-dark" class after below "dropdown-extended" to change the dropdown styte -->

      <!-- END QUICK SIDEBAR TOGGLER -->
    </div>
    <!-- END TOP NAVIGATION MENU -->
    <!-- END HEADER INNER -->
  </div>
  <!-- END HEADER -->
  <!-- BEGIN HEADER & CONTENT dropdown-divider -->
  <div class="clearfix"> </div>
  <!-- END HEADER & CONTENT dropdown-divider -->

  <!-- BEGIN CONTAINER -->
  <div class="page-container" ng-controller="moneyController">

    <aside class="sidebar">
      <nav class="sidebar-nav">
        <ul class="metismenu" id="menu">
          <li class="">
            <a href="/">
              <i class="icon options"></i>
              <span class="nav-label">Quản lý chung</span>
            </a>


          </li>
          <li class="">
            <a href="/products">
              <i class="icon shopping bag"></i>
              <span class="nav-label">Thêm đơn hàng</span>
            </a>
          </li>
          <li class="active">
            <a href="/result">
              <i class="icon industry"></i>
              <span class="nav-label">Thống kê hàng</span>
            </a>
          </li>
        </ul>
        <!-- END SIDEBAR MENU -->
        <!-- END SIDEBAR MENU -->
      </nav>
      <!-- END SIDEBAR -->
    </aside>

    <!-- BEGIN CONTENT BODY -->
    <div class="page-content-wrapper">
      <div class="content-wrapper container">
        <div class="row">
          <div class="col-sm-12">
            <div class="page-title">

              <h4 class="float-left">Thêm đơn hàng</h4>


            </div>
          </div>
        </div>
        <!-- end .page title-->
        <form class="ui form">
          <div class="field">
            <label>Tên Sản phẩm:</label>
            <div class="field">
              <div class="ui left icon input">
                <input type="text" placeholder="Tên sản phẩm" ng-model="tensanpham" required>
                <i class="cube icon"></i>
              </div>
            </div>

          </div>
          <div class="field">
            <label>Phí ship:</label>
            <div class="field">
              <div class="ui left icon input">
                <input type="number" placeholder="Phí ship" ng-model="tienship" required>
                <i class="shipping icon"></i>
              </div>
            </div>
          </div>
          <div class="field">
            <label>Số lượng:</label>
            <div class="field">
              <div class="ui left icon input">
                <input type="number" placeholder="Số lượng" ng-model="soluong" required>
                <i class="cubes icon"></i>
              </div>
            </div>
          </div>
          <div class="field">
            <label>Số tiền gốc:</label>
            <div class="field">
              <div class="ui left icon input">
                <input type="number" placeholder="Số tiền nhập" ng-model="nhap" required>
                <i class="pointing left icon"></i>
              </div>
            </div>
          </div>
          <div class="field">
            <label>Số tiền bán:</label>
            <div class="field">
              <div class="ui left icon input">
                <input type="number" placeholder="Số tiền bán" ng-model="xuat" required>
                <i class="pointing right icon"></i>
              </div>
            </div>
          </div>
          <div class="field">
            <label>Thời gian đơn hàng:</label>
            <div class="field">
              <div class="ui calendar" id="datetime">
                <div class="ui input left icon">
                  <i class="calendar icon"></i>
                  <input type="text" placeholder="Thời gian hoàn thành đơn hàng" ng-model="thoigian" id="thoigian">

                </div>
              </div>
            </div>
          </div>
          <div class="ui green button" id="add" ng-click="addLine()">
            <i class="plus icon"></i> Add new
          </div>
      </div>

    </div>
    <!-- END CONTENT BODY -->
    <!-- END CONTAINER -->
    <!-- /wrapper -->


    <!-- SCROLL TO TOP -->

    <!-- /PRELOADER -->
  </div>

  <script>
    $('#datetime').calendar();
    $('#month').calendar({
      type: 'month'
    });

    $('.menu-toggler').click(function () {
      if ($('.sidebar').hasClass("sidebar-right")) {
        $('.sidebar').removeClass('sidebar-right');
        $('.page-content-wrapper').removeClass('blur-backdrop');
      } else {
        $('.sidebar').addClass('sidebar-right');
        $('.page-content-wrapper').addClass('blur-backdrop');
      }
    })

    $('.page-content-wrapper').click(function () {
      $('.sidebar').removeClass('sidebar-right');
      $('.page-content-wrapper').removeClass('blur-backdrop');
    })

    function moneyController($scope, $http) {

      /* DECLARE */
      $scope.nhap = "";
      $scope.xuat = "";
      $scope.soluong = "";
      $scope.lengthTong = 0;
      $scope.list = [];
      $scope.listTmp = [];
      $scope.curPage = 0;
      $scope.lai = 0;
      $scope.tongnhap = 0;
      $scope.phantram = 0;
      $scope.sopage = 0;
      $scope.listpage = [];
      $scope.tienship = "";
      $scope.curItems = 0;
      $scope.keySearch = "";
      $scope.donhangthang = moment(new Date()).format().split("-")[1];
      $scope.monthSearch = moment(new Date()).format().split("-")[0] + "-" +
        moment(new Date()).format().split("-")[1]; // init month search
      $("#monthYear").val($scope.monthSearch); //init month year
      $scope.messagedata = "Không có dữ liệu";
      $scope.tensanpham = "";
      $scope.thoigian = "";
      $scope.condition = 'where={"tensanpham":{"contains":"' + $scope.keySearch +
        '"},"createdAt":{"contains":"' + $scope.monthSearch + '"}}';


      var myUrl = "http://52.41.8.125:82/users";
      if (getCookie("keyHaTool") != "hakhung" || getCookie("keyHaTool") == "") {
        auth();
      } else controller();
      /* On INIT */
      setCookie("keyHaTool", "hakhung", 1);
      function auth() {
        swal({
          title: 'Đăng nhập',
          input: 'password',
          confirmButtonText: 'Đăng nhập',
          showLoaderOnConfirm: true,
          preConfirm: function (email) {
            return new Promise(function (resolve, reject) {
              setTimeout(function () {
                if (email != 'hakhung') {
                  reject('Sai mật khẩu')
                } else {
                  resolve()
                }
              }, 1000)
            })
          },
          allowOutsideClick: false
        }).then(function () {
          swal({
            type: 'success',
            title: 'Mật khẩu xác nhận',
            html: 'Chào mừng bạn đến với ứng dụng quản lý lãi vốn'
          });
          setCookie("keyHaTool", "hakhung", 1);
          controller();
        }, function (dismiss) {
          auth();
        })
      }

      function setCookie(cname, cvalue, exdays) {
        var d = new Date();
        d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
        var expires = "expires=" + d.toUTCString();
        document.cookie = cname + "=" + cvalue + ";" + expires + "quanly.wolfhub.co";
      }

      function getCookie(cname) {
        var name = cname + "=";
        var decodedCookie = decodeURIComponent(document.cookie);
        var ca = decodedCookie.split(';');
        for (var i = 0; i < ca.length; i++) {
          var c = ca[i];
          while (c.charAt(0) == ' ') {
            c = c.substring(1);
          }
          if (c.indexOf(name) == 0) {
            return c.substring(name.length, c.length);
          }
        }
        return "";
      }


      function controller() {
        /**
         * On init
         **/


        $("#thoigian").focusout(function () {
          $scope.thoigian = $("#thoigian").val();
        });

        $("#monthYear").focusout(function () {
          $scope.monthSearch = convertMonthYear();
          console.log($scope.monthSearch);
        });

        function convertMonthYear() {
          var token = $("#monthYear").val().split(" ");
          if (token[0] === "January") {
            token[0] = "01";
          } else if (token[0] === "February") {
            token[0] = "02";
          } else if (token[0] === "March") {
            token[0] = "03";
          } else if (token[0] === "April") {
            token[0] = "04";
          } else if (token[0] === "May") {
            token[0] = "05";
          } else if (token[0] === "June") {
            token[0] = "06";
          } else if (token[0] === "July") {
            token[0] = "07";
          } else if (token[0] === "August") {
            token[0] = "08";
          } else if (token[0] === "September") {
            token[0] = "09";
          } else if (token[0] === "October") {
            token[0] = "10";
          } else if (token[0] === "November") {
            token[0] = "11";
          } else if (token[0] === "December") {
            token[0] = "12";
          }
          $scope.donhangthang = token[0];
          return token[1] + "-" + token[0];
        }



        $scope.isEnter = function (event) //Enter to search
        {
          if (keyEvent.which === 13)
            $scope.search();
        }

        /**
         *  ADD NEW LINE
         **/

        $scope.addLine = function () {
          var nhap = $scope.nhap;
          var xuat = $scope.xuat;
          var soluong = $scope.soluong;
          var tensp = $scope.tensanpham;
          var tienshp = $scope.tienship;
          var thoigian = $scope.thoigian;
          if (tienshp == "") tienshp = 0;
          if (thoigian == "") {
            thoigian = null;
          }
          else thoigian =  moment($scope.thoigian).format();
          var parm = {
            nhap: nhap,
            xuat: xuat,
            tienship: tienshp,
            soluong: soluong,
            tensanpham: tensp,
            createdAt: thoigian
          };

          if (nhap == 0 || nhap == "" || xuat == 0 || xuat == "" || soluong == 0 ||
            soluong == "" ||
            tensp == "") {
            alert('Không được bỏ trống');
            return;
          } else {

            $("#add").addClass('loading');
            $http.post(myUrl, parm).success(function (response) {
              toastr.success('Thêm mới một đơn hàng thành công');
              $("#add").removeClass('loading');
              $scope.tensanpham = "";
              $scope.nhap = "";
              $scope.xuat = "";
              $scope.tienship = "";
              $scope.soluong = "";
              $scope.thoigian = "";
            });
          }
        }
      }
    }
  </script>
  <div class="footer">
    <span class="footer-text left">ver 0.3</span>
    <span class="footer-text right">Ha Tools application</span>
  </div>
</body>

</html>
